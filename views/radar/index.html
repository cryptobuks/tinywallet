<script src="https://unpkg.com/vuebars@0.1.8/dist/vue-bars.js"></script>

<div id="app">
    <div class="py-2 font-black flex items-center">
        <div>Skyrocket Token</div>
        <img src="/resource/SVG/interface/analytics.svg" class=" mx-2 w-8"/>
        <div class="flex-1"></div>
        <input  v-model="symbol" @keyup.enter="enterSymbol" class="border rounded p-2 border-gray-400" placeholder="Token symbol: e.g. APE">
    </div>

    <div class="w-full">
        <div class="inline-block w-1/3 p-2 " v-for="skyrocket in skyrockets" >

            <a target="_blank" v-bind:href='"/token/1/"+skyrocket.symbol' class="block box-border border-gray-200 rounded border p-2">
                <div>{{skyrocket.symbol}}</div>
                <bars :data="skyrocket.data" :gradient="['#000000', '#000000']"> </bars>
            </a>
        </div>
    </div>
    <div class="py-2 font-black">Token Logs</div>
    <a
        target="_blank"
        v-bind:href="'https://etherscan.io/tx/' + flow.hash"
        class="cursor-pointer my-2 bg-gray-100 rounded p-2 flex items-center hover:bg-blue-200"
        v-for="flow in flows"
    >
        <div class="w-48">
            <div class="text-sm font-semibold">{{flow.symbol}}</div>
            <div class="text-xs">{{flow.name}}</div>
        </div>
        <div class="flex-1 px-2 text-xs">
            <div class="text-gray-500">
                <span class="inline-block w-12">FROM:</span>{{flow.from}}
            </div>
            <div class="text-gray-500">
                <span class="inline-block w-12">TO: </span>{{flow.to}}
            </div>
            <div class="">
                <span class="inline-block w-12">VALUE: </span>{{flow.value}}
            </div>
        </div>
        <div class="text-gray-400 text-xs">{{flow.time}}</div>
    </a>
</div>

<script>

    new Vue({
        el: "#app",
        data() {
            return {
                flows: [],
                skyrockets: [],
                symbol: ''
            };
        },
        methods: {
            enterSymbol: function(){
                location.href="/token/1/"+this.symbol
            }
        },
        // filters: {
        //     fromNow: function (time) {
        //         console.log(time);
        //         return new dayjs(time).fromNow();
        //     },
        // },
        created: function () {
            axios.get("/api/radar/flows").then((res) => {
                let flows = this.flows.concat(res.data);
                for(let flow of flows){
                    flow.time = new dayjs(flow.time).fromNow();
                }
                this.flows = flows
            });


            axios.get("/api/radar/skyrockets").then((res) => {
                this.skyrockets = res.data
            });
        },
    });
</script>
